<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Backtesting · Planar.jl</title><meta name="title" content="Backtesting · Planar.jl"/><meta property="og:title" content="Backtesting · Planar.jl"/><meta property="twitter:title" content="Backtesting · Planar.jl"/><meta name="description" content="Documentation for Planar.jl."/><meta property="og:description" content="Documentation for Planar.jl."/><meta property="twitter:description" content="Documentation for Planar.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../presentation/"><img src="../../assets/logo.png" alt="Planar.jl logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><span class="tocitem">Introduction</span><ul><li><a class="tocitem" href="../../presentation/">Overview</a></li><li><a class="tocitem" href="../../">What is Planar?</a></li></ul></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../../getting-started/">Overview</a></li><li><a class="tocitem" href="../../getting-started/quick-start/">Quick Start</a></li><li><a class="tocitem" href="../../getting-started/installation/">Installation</a></li><li><a class="tocitem" href="../../getting-started/first-strategy/">First Strategy</a></li></ul></li><li><span class="tocitem">User Guides</span><ul><li><a class="tocitem" href="../../strategy/">Strategy Development</a></li><li><a class="tocitem" href="../../data/">Data Management</a></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Execution Modes</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../engine/">Overview</a></li><li class="is-active"><a class="tocitem" href>Backtesting</a><ul class="internal"><li><a class="tocitem" href="#Backtest-Configuration"><span>Backtest Configuration</span></a></li><li><a class="tocitem" href="#Basic-Example"><span>Basic Example</span></a></li><li><a class="tocitem" href="#Comprehensive-Backtest-Example"><span>Comprehensive Backtest Example</span></a></li><li><a class="tocitem" href="#Advanced-Backtesting-Features"><span>Advanced Backtesting Features</span></a></li><li class="toplevel"><a class="tocitem" href="#Orders"><span>Orders</span></a></li><li><a class="tocitem" href="#Limit-Order-Types"><span>Limit Order Types</span></a></li><li><a class="tocitem" href="#Market-Order-Types"><span>Market Order Types</span></a></li><li><a class="tocitem" href="#Market-Orders"><span>Market Orders</span></a></li><li><a class="tocitem" href="#Checks"><span>Checks</span></a></li><li><a class="tocitem" href="#Fees"><span>Fees</span></a></li><li><a class="tocitem" href="#Slippage"><span>Slippage</span></a></li><li><a class="tocitem" href="#Liquidations"><span>Liquidations</span></a></li><li><a class="tocitem" href="#See-Also"><span>See Also</span></a></li><li><a class="tocitem" href="#Backtesting-Performance"><span>Backtesting Performance</span></a></li></ul></li><li><a class="tocitem" href="../paper/">Paper Trading</a></li><li><a class="tocitem" href="../live/">Live Trading</a></li><li><a class="tocitem" href="../mode-comparison/">Mode Comparison</a></li><li><a class="tocitem" href="../features/">Features</a></li></ul></li><li><a class="tocitem" href="../../optimization/">Optimization</a></li><li><a class="tocitem" href="../../plotting/">Visualization</a></li><li><a class="tocitem" href="../../metrics/">Performance Analysis</a></li></ul></li><li><span class="tocitem">Data Sources</span><ul><li><a class="tocitem" href="../../exchanges/">Exchanges</a></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Watchers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../watchers/watchers/">Interface</a></li><li><input class="collapse-toggle" id="menuitem-4-2-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2-2"><span class="docs-label">APIs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../watchers/apis/coingecko/">CoinGecko</a></li><li><a class="tocitem" href="../../watchers/apis/coinpaprika/">CoinPaprika</a></li><li><a class="tocitem" href="../../watchers/apis/coinmarketcap/">CoinMarketCap</a></li></ul></li></ul></li></ul></li><li><span class="tocitem">Advanced Topics</span><ul><li><input class="collapse-toggle" id="menuitem-5-1" type="checkbox"/><label class="tocitem" for="menuitem-5-1"><span class="docs-label">Customization &amp; Extensions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../customizations/customizations/">Overview</a></li><li><a class="tocitem" href="../../customizations/orders/">Custom Orders</a></li><li><a class="tocitem" href="../../customizations/backtest/">Backtester Customization</a></li><li><a class="tocitem" href="../../customizations/exchanges/">Exchange Extensions</a></li></ul></li><li><a class="tocitem" href="../../types/">Type System</a></li><li><a class="tocitem" href="../../devdocs/">Developer Documentation</a></li></ul></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../../documentation-index/">Documentation Index</a></li><li><input class="collapse-toggle" id="menuitem-6-2" type="checkbox"/><label class="tocitem" for="menuitem-6-2"><span class="docs-label">API Documentation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../API/collections/">Collections</a></li><li><a class="tocitem" href="../../API/data/">Data</a></li><li><a class="tocitem" href="../../API/ccxt/">CCXT</a></li><li><a class="tocitem" href="../../API/dfutils/">DataFrame Utils</a></li><li><a class="tocitem" href="../../API/executors/">Executors</a></li><li><a class="tocitem" href="../../API/exchanges/">Exchanges</a></li><li><a class="tocitem" href="../../API/fetch/">Fetch</a></li><li><a class="tocitem" href="../../API/engine/">Engine</a></li><li><a class="tocitem" href="../../API/instances/">Instances</a></li><li><a class="tocitem" href="../../API/instruments/">Instruments</a></li><li><a class="tocitem" href="../../API/misc/">Miscellaneous</a></li><li><a class="tocitem" href="../../API/optimization/">Optimization</a></li><li><a class="tocitem" href="../../API/pbar/">Progress Bars</a></li><li><a class="tocitem" href="../../API/plotting/">Plotting</a></li><li><a class="tocitem" href="../../API/prices/">Prices</a></li><li><a class="tocitem" href="../../API/processing/">Processing</a></li><li><a class="tocitem" href="../../API/python/">Python Integration</a></li><li><a class="tocitem" href="../../API/metrics/">Metrics</a></li><li><a class="tocitem" href="../../API/strategies/">Strategies</a></li><li><a class="tocitem" href="../../API/strategytools/">Strategy Tools</a></li><li><a class="tocitem" href="../../API/strategystats/">Strategy Stats</a></li></ul></li><li><a class="tocitem" href="../../config/">Configuration</a></li><li><a class="tocitem" href="../../disambiguation/">Glossary</a></li></ul></li><li><span class="tocitem">Support</span><ul><li><a class="tocitem" href="../../troubleshooting/">Troubleshooting</a></li><li><a class="tocitem" href="../../contacts/">Community</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User Guides</a></li><li><a class="is-disabled">Execution Modes</a></li><li class="is-active"><a href>Backtesting</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Backtesting</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/BubbleParticles/Planar.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/BubbleParticles/Planar.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Running-a-Backtest"><a class="docs-heading-anchor" href="#Running-a-Backtest">Running a Backtest</a><a id="Running-a-Backtest-1"></a><a class="docs-heading-anchor-permalink" href="#Running-a-Backtest" title="Permalink"></a></h1><p>To perform a <a href="../../guides/execution-modes/#simulationmode">backtest</a>, you need to construct a [Strategy Documentation](../<a href="../../guides/strategy-development/">strategy</a>. Once the <a href="../../guides/strategy-development/">strategy</a> is created, you can call the <code>start!</code> function on it to begin the <a href="../../guides/execution-modes/#simulationmode">backtest</a>.</p><p>The entry function that is called in all modes is <code>call!(s::Strategy, ts::DateTime, ctx)</code>. This function takes three arguments:</p><ul><li><code>s</code>: The strategy object that you have created.</li><li><code>ts</code>: The current date. In live mode, it is very close to <code>now()</code>, while in <a href="../../guides/execution-modes/#simulation-mode">simulation</a> mode, it is the date of the iteration step.</li><li><code>ctx</code>: Additional context information that can be passed to the function.</li></ul><p>During the <a href="../../guides/execution-modes/#simulation-mode">backtest</a>, the <code>call!</code> function is responsible for executing the strategy&#39;s logic at each timestep. It is called repeatedly with updated values of <code>ts</code> until the backtest is complete.</p><p>It is important to note that the <code>call!</code> function should be implemented in your strategy module according to your specific trading logic.</p><h2 id="Backtest-Configuration"><a class="docs-heading-anchor" href="#Backtest-Configuration">Backtest Configuration</a><a id="Backtest-Configuration-1"></a><a class="docs-heading-anchor-permalink" href="#Backtest-Configuration" title="Permalink"></a></h2><p>Before running a backtest, you can configure various parameters to control the simulation behavior:</p><h3 id="Time-Range-Configuration"><a class="docs-heading-anchor" href="#Time-Range-Configuration">Time Range Configuration</a><a id="Time-Range-Configuration-1"></a><a class="docs-heading-anchor-permalink" href="#Time-Range-Configuration" title="Permalink"></a></h3><h3 id="Initial-Capital-and-Position-Sizing"><a class="docs-heading-anchor" href="#Initial-Capital-and-Position-Sizing">Initial Capital and Position Sizing</a><a id="Initial-Capital-and-Position-Sizing-1"></a><a class="docs-heading-anchor-permalink" href="#Initial-Capital-and-Position-Sizing" title="Permalink"></a></h3><h3 id="Performance-Optimization-Settings"><a class="docs-heading-anchor" href="#Performance-Optimization-Settings">Performance Optimization Settings</a><a id="Performance-Optimization-Settings-1"></a><a class="docs-heading-anchor-permalink" href="#Performance-Optimization-Settings" title="Permalink"></a></h3><p>For large backtests, consider these <a href="../../optimization/">optimization</a> settings:</p><h2 id="Basic-Example"><a class="docs-heading-anchor" href="#Basic-Example">Basic Example</a><a id="Basic-Example-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-Example" title="Permalink"></a></h2><p>Here is an example of how to use the <code>call!</code> function in a strategy module:</p><p>Let&#39;s run a backtest.</p><p>Our backtest indicates that our strategy:</p><ul><li>Operated on <strong>3 assets</strong> (instances)</li><li>Executed <strong>977 trades</strong></li><li>Started with <strong>100 USDT</strong> and finished with <strong>32 USDT</strong> in cash, and assets worth <strong>156 USDT</strong></li><li>The asset with the minimum value at the end was <strong>BTC</strong>, and the one with the maximum value was <strong>XMR</strong></li><li>At the end, there were <strong>3 open buy orders</strong> and <strong>no open sell orders</strong>.</li></ul><h2 id="Comprehensive-Backtest-Example"><a class="docs-heading-anchor" href="#Comprehensive-Backtest-Example">Comprehensive Backtest Example</a><a id="Comprehensive-Backtest-Example-1"></a><a class="docs-heading-anchor-permalink" href="#Comprehensive-Backtest-Example" title="Permalink"></a></h2><p>Here&#39;s a more detailed example showing a complete <a href="../../guides/execution-modes/#simulation-mode">backtesting</a> workflow:</p><h2 id="Advanced-Backtesting-Features"><a class="docs-heading-anchor" href="#Advanced-Backtesting-Features">Advanced Backtesting Features</a><a id="Advanced-Backtesting-Features-1"></a><a class="docs-heading-anchor-permalink" href="#Advanced-Backtesting-Features" title="Permalink"></a></h2><h3 id="Multi-Timeframe-Backtesting"><a class="docs-heading-anchor" href="#Multi-Timeframe-Backtesting">Multi-Timeframe Backtesting</a><a id="Multi-Timeframe-Backtesting-1"></a><a class="docs-heading-anchor-permalink" href="#Multi-Timeframe-Backtesting" title="Permalink"></a></h3><h3 id="Walk-Forward-Analysis"><a class="docs-heading-anchor" href="#Walk-Forward-Analysis">Walk-Forward Analysis</a><a id="Walk-Forward-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Walk-Forward-Analysis" title="Permalink"></a></h3><h1 id="Orders"><a class="docs-heading-anchor" href="#Orders">Orders</a><a id="Orders-1"></a><a class="docs-heading-anchor-permalink" href="#Orders" title="Permalink"></a></h1><p>To place a limit order within your strategy, you call <code>call!</code> just like any call to the executor. Here are the arguments:</p><p>Where <code>s</code> is your <code>Strategy{Sim, ...}</code> instance, <code>ai</code> is the <code>AssetInstance</code> to which the order refers (it should be one present in your <code>s.universe</code>). The <code>amount</code> is the quantity in base currency and <code>date</code> should be the one fed to the <code>call!</code> function. During <a href="../../guides/execution-modes/#simulation-mode">backtesting</a>, this would be the current timestamp being evaluated, and during <a href="../../guides/execution-modes/#live-mode">live trading</a>, it would be a recent timestamp. If you look at the example strategy, <code>ts</code> is <em>current</em> and <code>ats</code> is <em>available</em>. The available timestamp <code>ats</code> is the one that matches the last candle that doesn&#39;t give you forward knowledge. The <code>date</code> given to the order call (<code>call!</code>) must always be the <em>current</em> timestamp.</p><p>A limit order call might return a trade if the order was queued correctly. If the trade hasn&#39;t completed the order, the order is queued in <code>s.buy/sellorders[ai]</code>. If <code>isnothing(trade)</code> is <code>true</code>, it means the order failed and was not scheduled. This can happen if the cost of the trade did not meet the asset limits, or there wasn&#39;t enough commitable cash. If instead <code>ismissing(trade)</code> is <code>true</code>, it means that the order was scheduled, but no trade has yet been performed. In backtesting, this happens if the price of the order is too low (buy) or too high (sell) for the current candle high/low prices.</p><h2 id="Limit-Order-Types"><a class="docs-heading-anchor" href="#Limit-Order-Types">Limit Order Types</a><a id="Limit-Order-Types-1"></a><a class="docs-heading-anchor-permalink" href="#Limit-Order-Types" title="Permalink"></a></h2><p>In addition to GTC (Good Till Canceled) orders, there are also IOC (Immediate Or Cancel) and FOK (Fill Or Kill) orders:</p><ul><li><strong>GTC (Good Till Canceled)</strong>: This order remains active until it is either filled or canceled. Best for <a href="../../guides/strategy-development/">strategies</a> that can wait for favorable prices.</li><li><strong>IOC (Immediate Or Cancel)</strong>: This order must be executed immediately. Any portion of the order that cannot be filled immediately will be canceled. Useful for capturing immediate opportunities.</li><li><strong>FOK (Fill Or Kill)</strong>: This order must be executed in its entirety or not at all. Ideal when you need exact position sizes.</li></ul><p>All three are subtypes of a limit order, <code>&lt;: LimitOrder&gt;</code>. You can create them by calling <code>call!</code> as shown below:</p><h3 id="Comprehensive-Order-Examples"><a class="docs-heading-anchor" href="#Comprehensive-Order-Examples">Comprehensive Order Examples</a><a id="Comprehensive-Order-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Comprehensive-Order-Examples" title="Permalink"></a></h3><h4 id="Basic-Limit-Orders"><a class="docs-heading-anchor" href="#Basic-Limit-Orders">Basic Limit Orders</a><a id="Basic-Limit-Orders-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-Limit-Orders" title="Permalink"></a></h4><h4 id="Advanced-Order-Strategies"><a class="docs-heading-anchor" href="#Advanced-Order-Strategies">Advanced Order Strategies</a><a id="Advanced-Order-Strategies-1"></a><a class="docs-heading-anchor-permalink" href="#Advanced-Order-Strategies" title="Permalink"></a></h4><h4 id="Order-Management-Patterns"><a class="docs-heading-anchor" href="#Order-Management-Patterns">Order Management Patterns</a><a id="Order-Management-Patterns-1"></a><a class="docs-heading-anchor-permalink" href="#Order-Management-Patterns" title="Permalink"></a></h4><h2 id="Market-Order-Types"><a class="docs-heading-anchor" href="#Market-Order-Types">Market Order Types</a><a id="Market-Order-Types-1"></a><a class="docs-heading-anchor-permalink" href="#Market-Order-Types" title="Permalink"></a></h2><p>Market order types include:</p><ul><li><strong>MarketOrder</strong>: This order is executed at the best available price in the market. Use when immediate execution is more important than price.</li><li><strong>LiquidationOrder</strong>: This order is similar to a MarketOrder, but its execution price might differ from the candle price due to forced liquidation mechanics.</li><li><strong>ReduceOnlyOrder</strong>: This is a market order that is automatically triggered when manually closing a position. Only reduces existing positions, never increases them.</li></ul><p>All of these behave in the same way, except for the LiquidationOrder. For example, a ReduceOnlyOrder is triggered when manually closing a position, as shown below:</p><h3 id="Market-Order-Examples"><a class="docs-heading-anchor" href="#Market-Order-Examples">Market Order Examples</a><a id="Market-Order-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Market-Order-Examples" title="Permalink"></a></h3><h4 id="Basic-Market-Orders"><a class="docs-heading-anchor" href="#Basic-Market-Orders">Basic Market Orders</a><a id="Basic-Market-Orders-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-Market-Orders" title="Permalink"></a></h4><h4 id="Advanced-Market-Order-Strategies"><a class="docs-heading-anchor" href="#Advanced-Market-Order-Strategies">Advanced Market Order Strategies</a><a id="Advanced-Market-Order-Strategies-1"></a><a class="docs-heading-anchor-permalink" href="#Advanced-Market-Order-Strategies" title="Permalink"></a></h4><h4 id="Risk-Management-with-Market-Orders"><a class="docs-heading-anchor" href="#Risk-Management-with-Market-Orders">Risk Management with Market Orders</a><a id="Risk-Management-with-Market-Orders-1"></a><a class="docs-heading-anchor-permalink" href="#Risk-Management-with-Market-Orders" title="Permalink"></a></h4><h2 id="Market-Orders"><a class="docs-heading-anchor" href="#Market-Orders">Market Orders</a><a id="Market-Orders-1"></a><a class="docs-heading-anchor-permalink" href="#Market-Orders" title="Permalink"></a></h2><p>Although the ccxt library allows setting <code>timeInForce</code> for market orders because <a href="../../exchanges/">exchanges</a> generally permit it, there isn&#39;t definitive information about how a market order is handled in these cases. Given that we are dealing with cryptocurrencies, some contexts like open and close times days are lost. It&#39;s plausible that <code>timeInForce</code> only matters when the order book doesn&#39;t have enough liquidity; otherwise, market orders are always <em>immediate</em> and <em>fully filled</em> orders. For this reason, we always consider market orders as FOK orders, and they will always have <code>timeInForce</code> set to FOK when executed live (through ccxt) to match the backtester.</p><div class="admonition is-warning" id="Market-orders-can-be-surprising-340d1b8ea184e7da"><header class="admonition-header">Market orders can be surprising<a class="admonition-anchor" href="#Market-orders-can-be-surprising-340d1b8ea184e7da" title="Permalink"></a></header><div class="admonition-body"><p>Market orders <em>always</em> go through in the backtest. If the candle has no volume, the order incurs in <em>heavy</em> slippage, and the execution price of the trades <em>can</em> exceed the candle high/low price.</p></div></div><h2 id="Checks"><a class="docs-heading-anchor" href="#Checks">Checks</a><a id="Checks-1"></a><a class="docs-heading-anchor-permalink" href="#Checks" title="Permalink"></a></h2><p>Before an order is created, several checks are performed to sanitize the values. For instance, if the specified amount is too small, the system will automatically adjust it to the minimum allowable amount. However, if there isn&#39;t sufficient cash after this adjustment, the order will fail. For more information on precision and limits, please refer to the <a href="http://docs.ccxt.com/#/?id=precision-and-limits">ccxt documentation</a>.</p><h2 id="Fees"><a class="docs-heading-anchor" href="#Fees">Fees</a><a id="Fees-1"></a><a class="docs-heading-anchor-permalink" href="#Fees" title="Permalink"></a></h2><p>The fees are derived from the <code>AssetInstance</code> <code>fees</code> property, which is populated by parsing the ccxt data for the specific symbol. Every trade takes these fees into account.</p><h2 id="Slippage"><a class="docs-heading-anchor" href="#Slippage">Slippage</a><a id="Slippage-1"></a><a class="docs-heading-anchor-permalink" href="#Slippage" title="Permalink"></a></h2><p>Slippage is factored into the trade execution process. Here&#39;s how it works for different types of orders:</p><ul><li><p><strong>Limit Orders</strong>: These can only experience positive slippage. When an order is placed and the price moves in your favor, the actual execution price becomes slightly lower (for buy orders) or higher (for sell orders). The slippage formula considers volatility (high/low) and fill ratio (amount/volume). The more volume the order takes from the candle, the lower the positive slippage will be. Conversely, higher volatility leads to higher positive slippage. Positive slippage is only added for candles that move against the order side, meaning it will only be added on red candles for buys, and green candles for sells.</p></li><li><p><strong>Market Orders</strong>: These can only experience negative slippage. There is always a minimum slippage added, which by default corresponds to the difference between open and close prices (other formulas are available, check the API reference). On top of this, additional skew is added based on volume and volatility.</p></li></ul><h2 id="Liquidations"><a class="docs-heading-anchor" href="#Liquidations">Liquidations</a><a id="Liquidations-1"></a><a class="docs-heading-anchor-permalink" href="#Liquidations" title="Permalink"></a></h2><p>In <a href="../../guides/strategy-development/#margin-modes">isolated margin</a> mode, liquidations are triggered by checking the <code>LIQUIDATION_BUFFER</code>. You can customize the buffer size by setting the value of the environment variable <code>PLANAR_LIQUIDATION_BUFFER</code>. This allows you to adjust the threshold at which liquidations are triggered.</p><p>To obtain more accurate estimations, you can utilize the effective funding rate. This can be done by downloading the funding rate history using the <code>Fetch</code> module. By analyzing the funding rate history, you can gain insights into the funding costs associated with trading in <a href="../../guides/strategy-development/#margin-modes">isolated margin</a> mode.</p><h3 id="Liquidation-Mechanics"><a class="docs-heading-anchor" href="#Liquidation-Mechanics">Liquidation Mechanics</a><a id="Liquidation-Mechanics-1"></a><a class="docs-heading-anchor-permalink" href="#Liquidation-Mechanics" title="Permalink"></a></h3><h4 id="Liquidation-Buffer-Configuration"><a class="docs-heading-anchor" href="#Liquidation-Buffer-Configuration">Liquidation Buffer Configuration</a><a id="Liquidation-Buffer-Configuration-1"></a><a class="docs-heading-anchor-permalink" href="#Liquidation-Buffer-Configuration" title="Permalink"></a></h4><h4 id="Liquidation-Price-Calculation"><a class="docs-heading-anchor" href="#Liquidation-Price-Calculation">Liquidation Price Calculation</a><a id="Liquidation-Price-Calculation-1"></a><a class="docs-heading-anchor-permalink" href="#Liquidation-Price-Calculation" title="Permalink"></a></h4><h4 id="Liquidation-Risk-Management"><a class="docs-heading-anchor" href="#Liquidation-Risk-Management">Liquidation Risk Management</a><a id="Liquidation-Risk-Management-1"></a><a class="docs-heading-anchor-permalink" href="#Liquidation-Risk-Management" title="Permalink"></a></h4><h3 id="Funding-Rate-Integration"><a class="docs-heading-anchor" href="#Funding-Rate-Integration">Funding Rate Integration</a><a id="Funding-Rate-Integration-1"></a><a class="docs-heading-anchor-permalink" href="#Funding-Rate-Integration" title="Permalink"></a></h3><h2 id="See-Also"><a class="docs-heading-anchor" href="#See-Also">See Also</a><a id="See-Also-1"></a><a class="docs-heading-anchor-permalink" href="#See-Also" title="Permalink"></a></h2><ul><li><strong><a href="../../exchanges/">Exchanges</a></strong> - Exchange integration and configuration</li><li><strong><a href="../../config/">Config</a></strong> - Exchange integration and configuration</li><li><strong><a href="../../optimization/">Optimization</a></strong> - Performance optimization techniques</li><li><strong><a href="../../troubleshooting/performance-issues/">Performance Issues</a></strong> - Troubleshooting: Performance optimization techniques</li><li><strong><a href="../../guides/data-management/">Data Management</a></strong> - Guide: Data handling and management</li><li><strong><a href="../../exchanges/">Exchanges</a></strong> - Data handling and management</li></ul><h2 id="Backtesting-Performance"><a class="docs-heading-anchor" href="#Backtesting-Performance">Backtesting Performance</a><a id="Backtesting-Performance-1"></a><a class="docs-heading-anchor-permalink" href="#Backtesting-Performance" title="Permalink"></a></h2><p>Local benchmarking indicates that the <code>:Example</code> strategy, which employs FOK orders, operates on three assets, trades in spot markets, and utilizes a simple logic (which can be reviewed in the strategy code) to execute orders, currently takes approximately <code>~8 seconds</code> to cycle through <code>~1.3M * 3 (assets) ~= 3.9M candles</code>, executing <code>~6000 trades</code> on a single x86 core.</p><p>It&#39;s crucial to note that the type of orders executed and the number of trades performed can significantly impact the runtime, aside from other evident factors like additional strategy logic or the number of assets. Therefore, caution is advised when interpreting claims about a backtester&#39;s ability to process X rows in Y time without additional context. Furthermore, our order creation logic always ensures that order inputs adhere to the <a href="../../exchanges/">exchanges</a>&#39;s <a href="https://docs.ccxt.com/#/README?id=precision-and-limits">limits</a>, and we also incorporate slippage and probability calculations, enabling the backtester to be &quot;MC simmable&quot;.</p><p>Backtesting a strategy with margin will inevitably be slower due to the need to account for all the necessary calculations, such as position states and liquidation triggers.</p><h3 id="Performance-Optimization-Guidelines"><a class="docs-heading-anchor" href="#Performance-Optimization-Guidelines">Performance Optimization Guidelines</a><a id="Performance-Optimization-Guidelines-1"></a><a class="docs-heading-anchor-permalink" href="#Performance-Optimization-Guidelines" title="Permalink"></a></h3><h4 id="Memory-Management"><a class="docs-heading-anchor" href="#Memory-Management">Memory Management</a><a id="Memory-Management-1"></a><a class="docs-heading-anchor-permalink" href="#Memory-Management" title="Permalink"></a></h4><h4 id="CPU-Optimization"><a class="docs-heading-anchor" href="#CPU-Optimization">CPU Optimization</a><a id="CPU-Optimization-1"></a><a class="docs-heading-anchor-permalink" href="#CPU-Optimization" title="Permalink"></a></h4><h4 id="I/O-Optimization"><a class="docs-heading-anchor" href="#I/O-Optimization">I/O Optimization</a><a id="I/O-Optimization-1"></a><a class="docs-heading-anchor-permalink" href="#I/O-Optimization" title="Permalink"></a></h4><h3 id="Performance-Benchmarks"><a class="docs-heading-anchor" href="#Performance-Benchmarks">Performance Benchmarks</a><a id="Performance-Benchmarks-1"></a><a class="docs-heading-anchor-permalink" href="#Performance-Benchmarks" title="Permalink"></a></h3><table><tr><th style="text-align: right">Strategy Type</th><th style="text-align: right">Assets</th><th style="text-align: right">Timeframe</th><th style="text-align: right">Candles</th><th style="text-align: right">Trades</th><th style="text-align: right">Time</th><th style="text-align: right">Memory</th></tr><tr><td style="text-align: right">Simple MA</td><td style="text-align: right">3</td><td style="text-align: right">1h</td><td style="text-align: right">3.9M</td><td style="text-align: right">6K</td><td style="text-align: right">8s</td><td style="text-align: right">2GB</td></tr><tr><td style="text-align: right">Complex Multi-TF</td><td style="text-align: right">10</td><td style="text-align: right">1h/4h/1d</td><td style="text-align: right">12M</td><td style="text-align: right">15K</td><td style="text-align: right">45s</td><td style="text-align: right">6GB</td></tr><tr><td style="text-align: right">Margin Strategy</td><td style="text-align: right">5</td><td style="text-align: right">15m</td><td style="text-align: right">8M</td><td style="text-align: right">25K</td><td style="text-align: right">120s</td><td style="text-align: right">4GB</td></tr><tr><td style="text-align: right">High-Freq</td><td style="text-align: right">1</td><td style="text-align: right">1m</td><td style="text-align: right">2M</td><td style="text-align: right">50K</td><td style="text-align: right">30s</td><td style="text-align: right">1GB</td></tr></table><h3 id="Profiling-and-Debugging"><a class="docs-heading-anchor" href="#Profiling-and-Debugging">Profiling and Debugging</a><a id="Profiling-and-Debugging-1"></a><a class="docs-heading-anchor-permalink" href="#Profiling-and-Debugging" title="Permalink"></a></h3><h3 id="Optimization-Recommendations"><a class="docs-heading-anchor" href="#Optimization-Recommendations">Optimization Recommendations</a><a id="Optimization-Recommendations-1"></a><a class="docs-heading-anchor-permalink" href="#Optimization-Recommendations" title="Permalink"></a></h3><ol><li><p><strong>Data Management</strong>:</p><ul><li>Use Zarr format for large datasets</li><li>Implement data chunking for memory efficiency</li><li>Cache frequently accessed indicators</li></ul></li><li><p><strong>Strategy Logic</strong>:</p><ul><li>Minimize allocations in hot paths</li><li>Use in-place operations where possible</li><li>Avoid unnecessary calculations in the main loop</li></ul></li><li><p><strong>Order Processing</strong>:</p><ul><li>Batch order operations when possible</li><li>Use appropriate order types for your strategy</li><li>Consider order frequency impact on performance</li></ul></li><li><p><strong>Multi-Asset Strategies</strong>:</p><ul><li>Enable parallel processing for independent assets</li><li>Balance memory usage vs. processing speed</li><li>Consider asset correlation in <a href="../../optimization/">optimization</a></li></ul></li></ol></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../engine/">« Overview</a><a class="docs-footer-nextpage" href="../paper/">Paper Trading »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Wednesday 29 October 2025 04:30">Wednesday 29 October 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
